Match(a:ownerHistory) with a.ref as links
return links

match(a)<-[]-(p) 

detach a

delete a

match(rootedP:IfcOwnerHistory) WHERE rootedP.globalId = $link

merge (rootedP)-[IfcOwnerHistory]->(p)

------- 

Match(a:ownerHistory) with a.ref as link
Match()
match(a)<-[]-(newP) WHERE p.globalId = link

return a, newP


----
Match(a:ownerHistory) with a.ref as link
Match(a)<-[]-(oldP)

match (newP) WHERE newP.globalId = link

merge(newP)-[o:OWNS]->(oldP)

return newP